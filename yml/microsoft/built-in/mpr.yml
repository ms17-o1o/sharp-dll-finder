---
Name: mpr.dll
Author: Wietze Beukema
Created: '2022-05-21'
Vendor: Microsoft
ExpectedLocations:
- '%SYSTEM32%'
- '%SYSWOW64%'
VulnerableExecutables:
- Path: '%SYSTEM32%\bootcfg.exe'
  Type: Sideloading
- Path: '%SYSTEM32%\dcdiag.exe'
  Type: Sideloading
- Path: '%SYSTEM32%\dfsrdiag.exe'
  Type: Sideloading
- Path: '%SYSTEM32%\driverquery.exe'
  Type: Sideloading
- Path: '%SYSTEM32%\dsmgmt.exe'
  Type: Sideloading
- Path: '%SYSTEM32%\eventcreate.exe'
  Type: Sideloading
- Path: '%SYSTEM32%\filehistory.exe'
  Type: Environment Variable
  Variable: SYSTEMROOT
- Path: '%SYSTEM32%\getmac.exe'
  Type: Sideloading
- Path: '%SYSTEM32%\gpresult.exe'
  Type: Sideloading
- Path: '%SYSTEM32%\iesettingsync.exe'
  Type: Sideloading
- Path: '%SYSTEM32%\net.exe'
  Type: Sideloading
- Path: '%SYSTEM32%\ntdsutil.exe'
  Type: Sideloading
- Path: '%SYSTEM32%\openfiles.exe'
  Type: Sideloading
- Path: '%SYSTEM32%\pnpunattend.exe'
  Type: Sideloading
- Path: '%SYSTEM32%\rdpclip.exe'
  Type: Sideloading
- Path: '%SYSTEM32%\rekeywiz.exe'
  Type: Sideloading
- Path: '%SYSTEM32%\repadmin.exe'
  Type: Sideloading
- Path: '%SYSTEM32%\sdclt.exe'
  Type: Sideloading
- Path: '%SYSTEM32%\setupugc.exe'
  Type: Sideloading
- Path: '%SYSTEM32%\systeminfo.exe'
  Type: Sideloading
- Path: '%SYSTEM32%\taskkill.exe'
  Type: Sideloading
- Path: '%SYSTEM32%\waitfor.exe'
  Type: Sideloading
Resources:
- https://wietze.github.io/blog/save-the-environment-variables
- https://securityintelligence.com/posts/windows-features-dll-sideloading/
- https://github.com/xforcered/WFH
Acknowledgements:
- Name: Wietze
  Twitter: '@wietze'
- Name: Chris Spehn
  Twitter: "@ConsciousHacker"
